CSRF LOGIN
===========================

## Requirements

My exercise had two part.

1. Attack part
CSRF - Enable default CSRF protection, but do not include token in non-thymeleaf form --> error    
CSRF token on, but simple form (only has action instead of th:action) does not contain the token, so Spring Security rejects it

2. Fix part
CSRF - Enable default CSRF protection and include token in non-tyhmeleaf form --> no error
CSRF token on, but simple form (only has action instead of th:action), developer adds the token by hand

## Technical documentation

I have used JSP instead of Thymeleaf. The CSRF protection is automatically enabled in Spring Boot's Security pack, so the CSRF token is automatically generated for a session, after login.
For the first part (Attack) there is the home.jsp where you can see there is no CSRF-token included in the form:

```html
<form action="/post" method="POST">
	<input type="text" name="email" value="email"/>
	<input type="text" name="address" value="adress"/>
	<button type="submit" class="btn btn-primary">Submit</button>
</form>
```
And then, you get an error message. 

In the home-with-token.jsp you can see the fixed verison. There is two solution here. You can send the token via a hidden field in the form:
```html
<form action="/post" method="POST">
	<input type="text" name="email" value="email"/>
	<input type="text" name="address" value="adress"/>
	<input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
	<button type="submit" class="btn btn-primary">Submit</button>
</form>
```

Or, you van send it in the URL:
```html
<form action="/post?${_csrf.parameterName}=${_csrf.token}" method="POST">
    <input type="text" name="email" value="email"/>
	<input type="text" name="address" value="adress"/>
    <button type="submit" class="btn btn-primary">Submit</button>
</form>
```
These data are from the generated page's meta tags. The token and the parameterName was generated by the server.

There are a HomeController what is annotated by @Controller, so its methods give back a view. The root's view is the first part's exercise (home.jsp), the second's is the '/with-token' what you can find in the WEB-INF with name "home-with-token.jsp". The controller of the errors is in the ErrorPageController class. You also get an error if there is a problem with the CSRF token and when there is a 404 error, too. 

There are additional documentation, but - for the sake of better understanding - it can be found in the source code.


## User documentation
1. Start the Spring Boot Application. The server port is 8888. You should see the login page. Use admin:admin for the autenthication. Anything else will show an error message.

Then you get to the home.jsp where you can see the first part of the quest. Click to submit and you will see there is an error message.

2. At the top of the page you can navigate to the fixed page ("With token" page). Try the two kind of form and you'll see everything is fine.

3. Logging out will put you back to the login page.